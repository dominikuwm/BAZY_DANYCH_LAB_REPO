zad 1
1. 

2. SELECT k.nazwa 
FROM kreatura k
LEFT JOIN uczestnicy u ON k.idKreatury = u.id_uczestnika
WHERE u.id_wyprawy IS NULL;

3. SELECT w.nazwa, SUM(k.udzwig) as Suma_udzwigu
FROM wyprawa w
JOIN uczestnicy u ON w.id_wyprawy = u.id_wyprawy
JOIN kreatura k ON u.id_uczestnika = k.idKreatury
GROUP BY w.nazwa
zad 2
1.
 SELECT w.nazwa as 'Wyprawa', COUNT(u.id_uczestnika) as 'Liczba uczestników', GROUP_CONCAT(k.nazwa SEPARATOR ', ') as 'Nazwy uczestników'
FROM wyprawa w
LEFT JOIN uczestnicy u ON w.id_wyprawy = u.id_wyprawy
LEFT JOIN kreatura k ON u.id_uczestnika = k.idKreatury
GROUP BY w.nazwa;
zad 3

1. SELECT ifnull(count(etapy_wyprawy.sektor),0) AS ilosc_odwiedzin, sektor.nazwa FROM sektor LEFT JOIN etapy_wyprawy ON (etapy_wyprawy.sektor=sektor.id_sektora) GROUP BY sektor.id_sektora;

2. SELECT kreatura.nazwa, if(count(uczestnicy.id_wyprawy)>0,'bral udzial w wyprawie','nie bral udzialu w wyprawie') FROM kreatura LEFT JOIN uczestnicy ON (kreatura.idKreatury=uczestnicy.id_uczestnika) GROUP BY kreatura.idKreatury;

zad 4
1. SELECT wyprawa.nazwa, SUM(LENGTH(etapy_wyprawy.dziennik)) FROM etapy_wyprawy INNER JOIN wyprawa ON (wyprawa.id_wyprawy=etapy_wyprawy.idWyprawy) GROUP BY etapy_wyprawy.idWyprawy HAVING SUM(LENGTH(etapy_wyprawy.dziennik))<400;
2. select w.nazwa, sum(e.ilosc * z.waga) / count(distinct u.id_uczestnika) as srednio
from wyprawa w
join uczestnicy u on w.id_wyprawy=u.id_wyprawy
join ekwipunek e on u.id_uczestnika=e.idKreatury
join zasob z on e.idZasobu=z.idZasobu
group by w.id_wyprawy;

zad 5
1. `SELECT k.nazwa,
w.nazwa,
DATEDIFF(w.data_rozpoczecia, k.dataUr) as 'Wiek w dniach'
FROM kreatura k,
etapy_wyprawy ew,
wyprawa w,
sektor s,
uczestnicy u
WHERE ew.sektor = s.id_sektora
and k.idKreatury=u.id_uczestnika
and u.id_wyprawy=w.id_wyprawy
AND ew.idWyprawy = w.id_wyprawy
AND s.nazwa = "Chatka dziadka";`
